<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:osuautodeafen"
        xmlns:cs="clr-namespace:osuautodeafen.cs"
        xmlns:avalonia1="clr-namespace:LiveChartsCore.SkiaSharpView.Avalonia;assembly=LiveChartsCore.SkiaSharpView.Avalonia"
        xmlns:settings="clr-namespace:osuautodeafen.cs.Settings"
        xmlns:strainGraph="clr-namespace:osuautodeafen.cs.StrainGraph"
        xmlns:global="clr-namespace:"
        xmlns:presets="clr-namespace:osuautodeafen.cs.Settings.Presets"
        xmlns:progressIndicator="clr-namespace:osuautodeafen.cs.StrainGraph.ProgressIndicator"
        mc:Ignorable="d" d:DesignWidth="150" d:DesignHeight="250"
        x:Class="osuautodeafen.MainWindow"
        Title="osuautodeafen"
        x:DataType="local:MainWindow">


    <Window.Resources>
        <global:AverageColorCycleConverter x:Key="AverageColorCycleConverter" />
        <presets:BackgroundPathToBrushConverter x:Key="BackgroundPathToBrushConverter" />
        <global:InverseBooleanConverter x:Key="InverseBooleanConverter" />
        <settings:ColorBlendConverter x:Key="ColorBlendConverter" />
        <settings:CheckBoxBackgroundConverter x:Key="CheckBoxBackgroundConverter" />
        <SolidColorBrush x:Key="BaseBackgroundBrush" Color="#171717" />
        <SolidColorBrush x:Key="SliderThumbBackground" Color="{Binding AverageColorBrushDim.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="SliderThumbBackgroundPointerOver" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="SliderThumbBackgroundPressed" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="SliderTrackValueFill" Color="{Binding AverageColorBrushDim.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="SliderTrackValueFillPointerOver" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="SliderTrackValueFillPressed" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />

        <SolidColorBrush x:Key="ButtonBackgroundBrush" Color="{Binding AverageColorBrushLight.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="ButtonBackgroundBrushPointerOver" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="ButtonBackgroundBrushPressed" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="ButtonBackgroundBrushDisabled" Color="{Binding AverageColorBrushDark.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="ButtonBorderBrush" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="ButtonForegroundBrush" Color="{Binding AverageColorBrushDim.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="ButtonHighlightBrush" Color="{Binding AverageColorBrush.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="CheckBoxBackgroundBrush" Color="{Binding AverageColorBrushLight.Color}"
                         x:DataType="cs:SharedViewModel" />
        <SolidColorBrush x:Key="TooltipColorBrush" Color="{Binding AverageColorBrushDimmer.Color}"
                         x:DataType="cs:SharedViewModel" />
    </Window.Resources>
    <Window.Styles>

        <Style Selector="Button">
            <Setter Property="Background" Value="{StaticResource ButtonBackgroundBrush}" />
            <Setter Property="BorderBrush" Value="{StaticResource ButtonBackgroundBrush}" />
        </Style>

        <Style Selector="CheckBox.custom">
            <Setter Property="Background" Value="{StaticResource CheckBoxBackgroundBrush}" />
        </Style>

        <Style Selector="Button.preset-list-item:pointerover">
            <Setter Property="BorderBrush" Value="#FFF" />
            <Setter Property="BorderThickness" Value="2" />
            <Setter Property="Background" Value="#22000000" />
        </Style>
        <Style Selector="Button.preset-list-item:pressed">
            <Setter Property="BorderBrush" Value="#FF66CCFF" />
            <Setter Property="BorderThickness" Value="2" />
            <Setter Property="Background" Value="#44000000" />
        </Style>
        <Style Selector="Button:disabled">
            <Setter Property="Background" Value="{StaticResource ButtonBackgroundBrushDisabled}" />
            <Setter Property="Foreground" Value="{StaticResource ButtonForegroundBrush}" />
        </Style>
        <Style Selector="CheckBox.custom">
            <Setter Property="Template">
                <ControlTemplate>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="18" Height="18"
                                CornerRadius="3"
                                BorderBrush="Gray"
                                BorderThickness="1"
                                Margin="0,0,6,0"
                                VerticalAlignment="Center">
                            <Border.Background>
                                <MultiBinding Converter="{StaticResource CheckBoxBackgroundConverter}">
                                    <Binding Path="IsChecked" RelativeSource="{RelativeSource TemplatedParent}" />
                                    <Binding Path="Background" RelativeSource="{RelativeSource TemplatedParent}" />
                                </MultiBinding>
                            </Border.Background>
                            <Canvas Width="18" Height="18">
                                <Path
                                    Classes="custom-checkmark"
                                    Data="M4,9 L8,13 L14,5"
                                    Stroke="White"
                                    StrokeThickness="2"
                                    IsVisible="{TemplateBinding IsChecked}" />
                            </Canvas>
                        </Border>
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          VerticalAlignment="Center"
                                          Foreground="White" />
                    </StackPanel>
                </ControlTemplate>
            </Setter>
            <Setter Property="Background" Value="{StaticResource ButtonBackgroundBrush}" />
        </Style>
        <Style Selector="CheckBox.custom Path.custom-checkmark:disabled">
            <Setter Property="Opacity" Value="0.3" />
        </Style>
        <Style Selector="CheckBox.custom:disabled">
            <Setter Property="Background" Value="#444" />
        </Style>
    </Window.Styles>

    <Grid ZIndex="5">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="0" />
        </Grid.ColumnDefinitions>

        <Canvas ZIndex="99" IsHitTestVisible="False">
            <Border x:Name="CustomTooltip"
                    CornerRadius="8"
                    Padding="8"
                    ClipToBounds="True"
                    Opacity="0"
                    IsVisible="False">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource ColorBlendConverter}" x:DataType="cs:SharedViewModel">
                        <Binding Path="Color" Source="{StaticResource TooltipColorBrush}" />
                        <Binding Path="AverageColorBrushDark.Color" />
                    </MultiBinding>
                </Border.Background>
                <Grid>
                    <TextBlock x:Name="TooltipText"
                               TextWrapping="Wrap"
                               Foreground="White"
                               FontSize="13"
                               FontWeight="Regular"
                               HorizontalAlignment="Center"
                               TextAlignment="Center" />
                </Grid>
            </Border>
        </Canvas>


        <StackPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Top" x:Name="TextBlockPanel"
                    Margin="0,82,0,0">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,0" x:Name="osuautodeafenLogoPanel">
                <Image Name="osuLogo" Source="avares://osuautodeafen/Resources/osu_whitestroke.png" Height="60"
                       Margin="0,0,0,0" />
                <ContentControl Name="LogoHost" Margin="0,0,0,0" />
            </StackPanel>
            <TextBlock Text="{Binding CurrentAppVersion}" HorizontalAlignment="Center" VerticalAlignment="Top"
                       x:DataType="cs:SharedViewModel" Margin="0,0,0,10" Foreground="White" FontSize="14"
                       x:Name="VersionPanel" />
        </StackPanel>

        <!-- Main content -->
        <Grid Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <StackPanel x:Name="DebugConsolePanel"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Margin="0,20,0,0"
                        IsVisible="False">
                <TextBlock x:Name="DebugConsoleTextBlock"
                           x:DataType="cs:SharedViewModel"
                           HorizontalAlignment="Stretch"
                           VerticalAlignment="Stretch"
                           Margin="0,20,0,0"
                           Padding="0"
                           FontFamily="Consolas"
                           Foreground="White"
                           IsVisible="False"
                           TextWrapping="Wrap"
                           IsHitTestVisible="True"
                           FontSize="6" />
            </StackPanel>
            <Border x:Name="SettingsButtonContainer" Grid.Column="1" Margin="0,42,0,0">
                <Grid HorizontalAlignment="Right" VerticalAlignment="Top">

                    <Image Source="avares://osuautodeafen/Icons/outline.png"
                           Width="50" Height="50">
                        <Image.OpacityMask>
                            <MultiBinding Converter="{StaticResource ColorBlendConverter}"
                                          x:DataType="cs:SharedViewModel">
                                <Binding Path="Color" Source="{StaticResource BaseBackgroundBrush}" />
                                <Binding Path="AverageColorBrush.Color" />
                            </MultiBinding>
                        </Image.OpacityMask>
                    </Image>
                    <Button x:Name="SettingsButton"
                            Width="50" Height="50"
                            Background="{x:Null}"
                            BorderBrush="{x:Null}"
                            BorderThickness="0"
                            CornerRadius="0"
                            Click="SettingsButton_Click"
                            IsVisible="True"
                            ZIndex="1">
                        <Svg x:Name="SettingsCogImage"
                             Path="Icons/gear.svg"
                             Width="50"
                             Height="50"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             RenderTransformOrigin="0.5,0.5" />
                    </Button>
                </Grid>
            </Border>
        </Grid>
        <!--- settings panel -->
        <DockPanel x:Name="SettingsPanel" Grid.Column="1" Width="200" IsVisible="False"
                   Margin="0,42,0,0" ZIndex="3"
                   x:DataType="cs:SharedViewModel" HorizontalAlignment="Right">
            <DockPanel.Background>
                <MultiBinding Converter="{StaticResource ColorBlendConverter}">
                    <Binding Path="Color" Source="{StaticResource BaseBackgroundBrush}" />
                    <Binding Path="AverageColorBrush.Color" />
                </MultiBinding>
            </DockPanel.Background>
            <ScrollViewer VerticalScrollBarVisibility="Visible" Margin="0,0,0,0">
                <StackPanel HorizontalAlignment="Center">
                    <StackPanel Margin="0,5,0,0">
                        <Border Height="20" Background="Transparent">
                            <TextBlock Text="Editing Preset Settings"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Foreground="#ff3333"
                                       FontSize="12"
                                       FontWeight="Bold"
                                       IsVisible="{Binding CanCreatePreset, Converter={StaticResource InverseBooleanConverter}}" />
                        </Border>
                        <TextBlock Text="Deafen Settings"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,8"
                                   Foreground="White"
                                   FontSize="16" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                        <Svg Path="Icons/clock.svg" Width="32" Height="32"
                             Margin="0,0,5,0"
                             PointerEntered="CompletionPercentageImage_PointerEnter"
                             PointerExited="CompletionPercentageImage_PointerLeave">
                        </Svg>
                        <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                            <Slider x:Name="CompletionPercentageSlider"
                                    Minimum="0"
                                    Maximum="100"
                                    TickFrequency="0.01"
                                    IsSnapToTickEnabled="False"
                                    Value="{Binding MinCompletionPercentage, Mode=OneWayToSource}"
                                    Width="100"
                                    HorizontalAlignment="Center"
                                    ValueChanged="CompletionPercentageSlider_ValueChanged"
                                    PointerEntered="CompletionPercentageSlider_PointerEnter"
                                    PointerMoved="CompletionPercentageSlider_PointerMove"
                                    PointerExited="CompletionPercentageSlider_PointerLeave"
                                    PointerPressed="CompletionPercentageSlider_PointerPressed">
                            </Slider>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                        <Svg Path="Icons/star.svg" Width="32" Height="32"
                             Margin="0,0,5,3"
                             PointerEntered="StarRatingImage_PointerEnter"
                             PointerExited="StarRatingImage_PointerLeave">
                        </Svg>
                        <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                            <Slider x:Name="StarRatingSlider"
                                    Minimum="0"
                                    Maximum="10"
                                    TickFrequency="0.1"
                                    IsSnapToTickEnabled="False"
                                    Value="{Binding StarRating, Mode=OneWayToSource}"
                                    Width="100" HorizontalAlignment="Center"
                                    ValueChanged="StarRatingSlider_ValueChanged"
                                    PointerMoved="StarRatingSlider_PointerMove"
                                    PointerEntered="StarRatingSlider_PointerEnter"
                                    PointerExited="StarRatingSlider_PointerLeave"
                                    PointerPressed="StarRatingSlider_PointerPressed">
                            </Slider>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                        <Svg Path="Icons/star-ranking.svg" Width="32" Height="32"
                             Margin="0,0,5,0"
                             PointerEntered="PPImage_PointerEnter"
                             PointerExited="PPImage_PointerLeave">

                        </Svg>
                        <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                            <Slider x:Name="PPSlider"
                                    Minimum="0"
                                    Maximum="1000"
                                    TickFrequency="10"
                                    IsSnapToTickEnabled="True"
                                    Value="{Binding PerformancePoints, Mode=OneWayToSource}"
                                    Width="100" HorizontalAlignment="Center"
                                    ValueChanged="PPSlider_ValueChanged"
                                    PointerMoved="PPSlider_PointerMove"
                                    PointerEntered="PPSlider_PointerEnter"
                                    PointerPressed="PPSlider_PointerPressed"
                                    PointerExited="PPSlider_PointerLeave">
                            </Slider>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0" HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                PointerEntered="FCToggle_PointerEnter"
                                PointerExited="FCToggle_PointerLeave">
                        <Svg Path="Icons/crown.svg" Width="26" Height="26" Margin="0,0,5,0" VerticalAlignment="Center" />
                        <CheckBox x:Name="FCToggle" Content="FC Required?" Foreground="White"
                                  IsChecked="{Binding IsFCRequired, Mode=TwoWay}"
                                  HorizontalAlignment="Left" VerticalAlignment="Center"
                                  Margin="0" Width="125" Classes="custom" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0" HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                PointerEntered="UndeafenOnMissToggle_PointerEnter"
                                PointerExited="UndeafenOnMissToggle_PointerLeave"
                                x:Name="UndeafenOnMissPanel">
                        <Svg Path="Icons/meteor.svg" Width="26" Height="26" Margin="0,0,5,0" VerticalAlignment="Center" />
                        <CheckBox x:Name="UndeafenOnMissToggle" Content="Miss Undeafen" Foreground="White"
                                  IsChecked="{Binding UndeafenAfterMiss, Mode=TwoWay}"
                                  HorizontalAlignment="Left" VerticalAlignment="Center"
                                  Margin="0" Width="125" Classes="custom" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0" HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                PointerEntered="BreakUndeafenToggle_PointerEnter"
                                PointerExited="BreakUndeafenToggle_PointerLeave">
                        <Svg Path="Icons/map-location.svg" Width="26" Height="26" Margin="0,0,5,0"
                             VerticalAlignment="Center" />
                        <CheckBox x:Name="BreakUndeafenToggle" Content="Audible Breaks" Foreground="White"
                                  IsChecked="{Binding IsBreakUndeafenToggleEnabled, Mode=TwoWay}"
                                  HorizontalAlignment="Left" VerticalAlignment="Center"
                                  Margin="0" Width="125" Classes="custom" />
                    </StackPanel>

                    <Button Content="Reset to Default" Click="ResetButton_Click" Margin="0,7,0,0" FontSize="12"
                            Foreground="White" HorizontalAlignment="Center"
                            PointerEntered="ResetButton_PointerEnter"
                            PointerExited="ResetButton_PointerLeave" />
                    <Separator Margin="0,20,0,10" Background="{Binding AverageColorBrush}" />
                    <!--title-->
                    <TextBlock Text="Preset Settings"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,8"
                               Foreground="White"
                               FontSize="16" />
                    <StackPanel Orientation="Vertical" Margin="0,3,0,0" HorizontalAlignment="Center">
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="CreatePresetButton"
                                    Width="135"
                                    HorizontalAlignment="Left"
                                    FontSize="11"
                                    Margin="0"
                                    HorizontalContentAlignment="Center"
                                    VerticalContentAlignment="Center"
                                    IsVisible="{Binding CanCreatePreset}"
                                    PointerEntered="PresetCreate_PointerEnter"
                                    PointerExited="PresetCreate_PointerLeave">
                                <Button.Content>
                                    <StackPanel>
                                        <TextBlock Text="Create Map Preset for"
                                                   TextAlignment="Center" />
                                        <ScrollViewer HorizontalScrollBarVisibility="Hidden"
                                                      VerticalScrollBarVisibility="Disabled"
                                                      Width="130">
                                            <TextBlock Text="{Binding BeatmapName}"
                                                       Foreground="{Binding AverageColorBrush}"
                                                       TextAlignment="Center"
                                                       Classes="beatmap-name" />
                                        </ScrollViewer>
                                    </StackPanel>
                                </Button.Content>
                                <Button.Flyout>
                                    <Flyout Placement="TopEdgeAlignedRight" ShowMode="Transient">
                                        <StackPanel>
                                            <TextBlock Text="Are you sure you want to make a map preset for"
                                                       Foreground="White"
                                                       TextAlignment="Center" />
                                            <ScrollViewer HorizontalScrollBarVisibility="Hidden"
                                                          VerticalScrollBarVisibility="Disabled">
                                                <TextBlock TextAlignment="Center">
                                                    <Run Text="{Binding BeatmapName}"
                                                         Foreground="{Binding AverageColorBrush}" />
                                                    <Run Text="{Binding BeatmapDifficultyBrackets}"
                                                         Foreground="{Binding AverageColorBrush}" />
                                                </TextBlock>
                                            </ScrollViewer>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                        Margin="0,10,0,0">
                                                <Button Content="Yes"
                                                        Width="60"
                                                        Height="32"
                                                        Margin="8,0"
                                                        FontSize="14"
                                                        Background="#444"
                                                        Foreground="White"
                                                        CornerRadius="6"
                                                        HorizontalContentAlignment="Center"
                                                        VerticalContentAlignment="Center"
                                                        Click="PresetButtonYes_Click" />
                                                <Button Content="No"
                                                        Width="60"
                                                        Height="32"
                                                        Margin="8,0"
                                                        FontSize="14"
                                                        Background="#444"
                                                        Foreground="White"
                                                        CornerRadius="6"
                                                        HorizontalContentAlignment="Center"
                                                        VerticalContentAlignment="Center"
                                                        Click="PresetButtonNo_Click" />
                                            </StackPanel>
                                        </StackPanel>
                                    </Flyout>
                                </Button.Flyout>
                            </Button>
                            <Button x:Name="DeletePresetButton"
                                    Width="135"
                                    Classes="DeletePresetButton"
                                    HorizontalAlignment="Left"
                                    FontSize="11"
                                    Margin="0"
                                    HorizontalContentAlignment="Center"
                                    VerticalContentAlignment="Center"
                                    IsVisible="{Binding CanCreatePreset, Converter={StaticResource InverseBooleanConverter}}"
                                    Foreground="White"
                                    Background="#705959"
                                    BorderBrush="#996363"
                                    PointerEntered="PresetDelete_PointerEnter"
                                    PointerExited="PresetDelete_PointerLeave">
                                <Button.Content>
                                    <StackPanel>
                                        <TextBlock Text="Delete Map Preset for"
                                                   TextAlignment="Center" />
                                        <ScrollViewer HorizontalScrollBarVisibility="Hidden"
                                                      VerticalScrollBarVisibility="Disabled"
                                                      Width="130">
                                            <TextBlock Text="{Binding BeatmapName}"
                                                       Foreground="{Binding AverageColorBrush}"
                                                       TextAlignment="Center"
                                                       Classes="beatmap-name" />
                                        </ScrollViewer>
                                    </StackPanel>
                                </Button.Content>
                                <Button.Flyout>
                                    <Flyout Placement="Top" ShowMode="Transient">
                                        <StackPanel>
                                            <TextBlock>
                                                <Run Text="Are you sure you want to" Foreground="White" />
                                                <Run Text="delete" Foreground="#ff3333" FontWeight="Bold" />
                                                <Run Text="your map preset for" Foreground="White" />
                                            </TextBlock>
                                            <ScrollViewer HorizontalScrollBarVisibility="Hidden"
                                                          VerticalScrollBarVisibility="Disabled">
                                                <TextBlock TextAlignment="Center">
                                                    <Run Text="{Binding BeatmapName}"
                                                         Foreground="{Binding AverageColorBrush}" />
                                                    <Run Text="{Binding BeatmapDifficultyBrackets}"
                                                         Foreground="{Binding AverageColorBrush}" />
                                                </TextBlock>
                                            </ScrollViewer>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                        Margin="0,10,0,0">
                                                <Button Content="Yes"
                                                        Width="60"
                                                        Height="32"
                                                        Margin="8,0"
                                                        FontSize="14"
                                                        Background="#996363"
                                                        Foreground="White"
                                                        CornerRadius="6"
                                                        HorizontalContentAlignment="Center"
                                                        VerticalContentAlignment="Center"
                                                        Click="PresetButtonDeleteYes_Click" />
                                                <Button Content="No"
                                                        Width="60"
                                                        Height="32"
                                                        Margin="8,0"
                                                        FontSize="14"
                                                        Background="#444"
                                                        Foreground="White"
                                                        CornerRadius="6"
                                                        HorizontalContentAlignment="Center"
                                                        VerticalContentAlignment="Center"
                                                        Click="PresetButtonDeleteNo_Click" />
                                            </StackPanel>
                                        </StackPanel>
                                    </Flyout>
                                </Button.Flyout>
                            </Button>
                        </StackPanel>
                        <Button x:Name="LoadPresetButton"
                                Width="135"
                                HorizontalAlignment="Left"
                                FontSize="11"
                                Margin="0,3,0,0"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                IsEnabled="{Binding HasAnyPresetsNotCurrent}"
                                Click="LoadPresetButton_Click"
                                PointerEntered="LoadPresetButton_PointerEnter"
                                PointerExited="LoadPresetButton_PointerLeave">
                            <Button.Content>
                                <TextBlock Text="Load Preset" />
                            </Button.Content>
                            <Button.Flyout>
                                <Flyout Placement="TopEdgeAlignedRight" ShowMode="Transient">
                                    <ScrollViewer Height="200" Width="190" VerticalScrollBarVisibility="Visible">
                                        <ItemsControl ItemsSource="{Binding VisiblePresets}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Button Margin="2"
                                                            Width="200"
                                                            Height="40"
                                                            Click="PresetItem_Click"
                                                            Classes="preset-list-item"
                                                            Background="Transparent"
                                                            BorderBrush="{x:Null}"
                                                            BorderThickness="0"
                                                            HorizontalContentAlignment="Center"
                                                            HorizontalAlignment="Center"
                                                            IsEnabled="{Binding IsCurrentPreset, Converter={StaticResource InverseBooleanConverter}}">
                                                        <Grid Width="190" Height="35">
                                                            <Border
                                                                Background="{Binding BackgroundPath, Converter={StaticResource BackgroundPathToBrushConverter}}"
                                                                CornerRadius="6"
                                                                HorizontalAlignment="Stretch"
                                                                VerticalAlignment="Stretch"
                                                                BorderThickness="1.5">
                                                                <Border.BorderBrush>
                                                                    <MultiBinding
                                                                        Converter="{StaticResource AverageColorCycleConverter}">
                                                                        <!--saving for later we can do cool stuff here-->
                                                                        <Binding Path="AverageColor1" />
                                                                        <Binding Path="AverageColor2" />
                                                                        <Binding Path="AverageColor3" />
                                                                        <Binding Path="Index" />
                                                                    </MultiBinding>
                                                                </Border.BorderBrush>
                                                            </Border>
                                                            <TextBlock Text="{Binding BeatmapName}"
                                                                       VerticalAlignment="Center"
                                                                       HorizontalAlignment="Center"
                                                                       TextAlignment="Center"
                                                                       Foreground="{Binding IsCurrentPreset}"
                                                                       FontWeight="Bold" />
                                                        </Grid>
                                                    </Button>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </ScrollViewer>
                                </Flyout>
                            </Button.Flyout>
                        </Button>
                        <Button x:Name="DeleteAllPresetsButton"
                                Width="135"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                Margin="0,3,0,0"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                IsVisible="{Binding HasAnyPresets}"
                                Foreground="White"
                                Background="#705959"
                                BorderBrush="#996363"
                                PointerEntered="DeleteAllPresetsButton_PointerEnter"
                                PointerExited="DeleteAllPresetsButton_PointerLeave">
                            <Button.Content>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center"
                                            HorizontalAlignment="Center">
                                    <Svg Path="Icons/trash.svg"
                                         Width="15" Height="15"
                                         Margin="0,0,3,0"
                                         VerticalAlignment="Center" />
                                    <TextBlock Text="Delete All Presets" VerticalAlignment="Center"
                                               Margin="0,0,10,0" />
                                </StackPanel>
                            </Button.Content>
                            <Button.Flyout>
                                <Flyout Placement="Top" ShowMode="Transient">
                                    <StackPanel>
                                        <TextBlock>
                                            <Run Text="Are you sure you want to" Foreground="White" />
                                            <Run Text="delete" Foreground="#ff3333" FontWeight="Bold" />
                                            <Run Text="all of your presets?" Foreground="White" />
                                        </TextBlock>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center"
                                                    Margin="0,10,0,0">
                                            <Button Content="Yes"
                                                    Width="60"
                                                    Height="32"
                                                    Margin="8,0"
                                                    FontSize="14"
                                                    Background="#996363"
                                                    Foreground="White"
                                                    CornerRadius="6"
                                                    HorizontalContentAlignment="Center"
                                                    VerticalContentAlignment="Center"
                                                    Click="DeleteAllPresetsButtonYes_Click" />
                                            <Button Content="No"
                                                    Width="60"
                                                    Height="32"
                                                    Margin="8,0"
                                                    FontSize="14"
                                                    Background="#444"
                                                    Foreground="White"
                                                    CornerRadius="6"
                                                    HorizontalContentAlignment="Center"
                                                    VerticalContentAlignment="Center"
                                                    Click="DeleteAllPresetsButtonNo_Click" />
                                        </StackPanel>
                                    </StackPanel>
                                </Flyout>
                            </Button.Flyout>
                        </Button>
                    </StackPanel>
                    <Separator Margin="0,20,0,10" Background="{Binding AverageColorBrush}" />
                    <!--title-->
                    <TextBlock Text="Discord Settings"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,8"
                               Foreground="White"
                               FontSize="16" />
                    <StackPanel HorizontalAlignment="Center">
                        <StackPanel Orientation="Horizontal" Margin="0,10,10,0"
                                    PointerEntered="DeafenKeybindPanel_PointerEnter"
                                    PointerExited="DeafenKeybindPanel_PointerLeave">
                            <Svg Path="Icons/keyboard.svg" Width="32"
                                 Height="32" Margin="0,0,5,0">
                            </Svg>
                            <Button x:Name="DeafenKeybindButton" Width="100" Height="40"
                                    HorizontalAlignment="Left" FontSize="11" Margin="0"
                                    Content="{Binding DeafenKeybindDisplay}"
                                    HorizontalContentAlignment="Center"
                                    VerticalContentAlignment="Center"
                                    Click="DeafenKeybindButton_Click">
                                <!--this should probably include some sort of verification prompt in the near future.. maybe-->
                                <Button.Flyout>
                                    <Flyout>
                                        <TextBlock Text="Press any key(s) for the keybind..." />
                                    </Flyout>
                                </Button.Flyout>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                    <Separator Margin="0,20,0,10" Background="{Binding AverageColorBrush}" />
                    <!--title-->
                    <TextBlock Text="UI Settings"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,8"
                               Foreground="White"
                               FontSize="16" />

                    <StackPanel Orientation="Horizontal" Margin="10,7,0,0" HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                PointerEntered="BGToggle_PointerEnter"
                                PointerExited="BGToggle_PointerLeave">
                        <Svg Path="Icons/image.svg" Width="26" Height="26" Margin="0,0,5,0" VerticalAlignment="Center" />
                        <CheckBox x:Name="BackgroundToggle" Content="Background" Foreground="White"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding IsBackgroundEnabled, Mode=TwoWay}"
                                  HorizontalAlignment="Left" Margin="0" Width="125" Classes="custom" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0" HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                PointerEntered="ParallaxToggle_PointerEnter"
                                PointerExited="ParallaxToggle_PointerLeave">
                        <Svg Path="Icons/arrows.svg" Width="26" Height="26" Margin="0,0,5,0" VerticalAlignment="Center" />
                        <CheckBox x:Name="ParallaxToggle" Content="Parallax" Foreground="White"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding IsParallaxEnabled, Mode=TwoWay}"
                                  IsEnabled="{Binding ElementName=BackgroundToggle, Path=IsChecked}"
                                  HorizontalAlignment="Left" Margin="0" Width="125" Classes="custom" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0" HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                PointerEntered="KiaiEffectToggle_PointerEnter"
                                PointerExited="KiaiEffectToggle_PointerLeave">
                        <Svg Path="Icons/star-half.svg" Width="26" Height="26" Margin="0,0,5,0"
                             VerticalAlignment="Center" />
                        <CheckBox x:Name="KiaiEffectToggle" Content="Kiai Effect" Foreground="White"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding IsKiaiEffectEnabled, Mode=TwoWay}"
                                  IsEnabled="{Binding ElementName=BackgroundToggle, Path=IsChecked}"
                                  HorizontalAlignment="Left" Margin="0" Width="125" Classes="custom" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                        <Svg Path="Icons/layer-group.svg" Width="25" Height="25"
                             Margin="0,0,5,0"
                             PointerEntered="BlurEffectImage_PointerEnter"
                             PointerExited="BlurEffectImage_PointerLeave">
                        </Svg>
                        <Slider x:Name="BlurEffectSlider"
                                Minimum="0"
                                Maximum="20"
                                TickFrequency="0.1"
                                IsSnapToTickEnabled="True"
                                Value="{Binding BlurRadius, Mode=OneWayToSource}"
                                ValueChanged="BlurEffectSlider_ValueChanged"
                                PointerMoved="BlurEffectSlider_PointerMoved"
                                PointerEntered="BlurEffectSlider_PointerEnter"
                                PointerExited="BlurEffectSlider_PointerLeave"
                                PointerPressed="BlurEffectSlider_PointerPressed"
                                IsEnabled="{Binding ElementName=BackgroundToggle, Path=IsChecked}"
                                Width="100"
                                HorizontalAlignment="Left"
                                Margin="0" />
                    </StackPanel>
                    <Separator Margin="0,20,0,10" Background="{Binding AverageColorBrush}" />
                    <Button x:Name="CheckForUpdatesButton"
                            Content="Check for Updates"
                            HorizontalContentAlignment="Center"
                            Click="CheckForUpdatesButton_Click"
                            Width="180"
                            HorizontalAlignment="Center"
                            Margin="0,16.5,0,10"
                            FontSize="12"
                            Foreground="White"
                            VerticalAlignment="Bottom"
                            PointerEntered="CheckForUpdatesButton_PointerEnter"
                            PointerExited="CheckForUpdatesButton_PointerLeave" />
                    <TextBlock Text="{Binding CurrentAppVersion}" DockPanel.Dock="Bottom"
                               VerticalAlignment="Bottom" HorizontalAlignment="Center"
                               Margin="0,0,0,8" Foreground="White" FontSize="14" />
                    <Separator Margin="0,20,0,10" Background="{Binding AverageColorBrush}" />
                    <StackPanel Orientation="Horizontal" Margin="0" HorizontalAlignment="Center">
                        <Button x:Name="OpenFileLocationButton"
                                Width="50" Height="50"
                                Background="Transparent"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="OpenFileLocationButton_Click"
                                Margin="0,0,6,0"
                                PointerEntered="FileLocationButton_PointerEnter"
                                PointerExited="FileLocationButton_PointerLeave">
                            <Svg x:Name="OpenFileLocationImage"
                                 Path="Icons/folder.svg"
                                 Width="24" Height="24"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center" />
                        </Button>

                        <Button x:Name="ReportIssueButton"
                                Width="50" Height="50"
                                Background="Transparent"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="ReportIssueButton_Click"
                                Margin="0,0,6,0"
                                PointerEntered="ReportIssueButton_PointerEnter"
                                PointerExited="ReportIssueButton_PointerLeave">
                            <Svg x:Name="ReportIssueImage"
                                 Path="Icons/bug.svg"
                                 Width="24" Height="24"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center" />
                        </Button>

                        <Button x:Name="DebugConsoleButton"
                                Width="50" Height="50"
                                Background="Transparent"
                                BorderBrush="{x:Null}"
                                BorderThickness="0"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Click="ToggleDebugConsole"
                                PointerEntered="DebugConsoleButton_PointerEnter"
                                PointerExited="DebugConsoleButton_PointerLeave">
                            <Svg x:Name="DebugConsoleImage"
                                 Path="Icons/code.svg"
                                 Width="24" Height="24"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center" />
                        </Button>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </DockPanel>


        <Grid x:Name="MainContainer">
        </Grid>


        <Grid VerticalAlignment="Bottom">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <TextBlock Text="{Binding StatusMessage}" HorizontalAlignment="Center" VerticalAlignment="Top"
                       x:DataType="cs:SharedViewModel" Margin="0,0,0,0" Foreground="#ff3333" FontSize="14" />
            <Grid>
                <avalonia1:CartesianChart
                    x:Name="PlotView"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Height="120" />
                <progressIndicator:ProgressIndicatorOverlay
                    x:Name="ProgressOverlay"
                    IsHitTestVisible="False" />
                <Canvas x:Name="IconOverlay" IsHitTestVisible="False" x:DataType="cs:SharedViewModel" />
            </Grid>
            <Grid HorizontalAlignment="Stretch" x:Name="UpdateNotificationGrid" VerticalAlignment="Bottom"
                  Grid.Row="2" IsVisible="{Binding IsVisible, ElementName=UpdateNotificationBar}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Button x:Name="UpdateNotificationBar"
                        IsVisible="False"
                        HorizontalAlignment="Stretch"
                        FontSize="12"
                        Foreground="White"
                        x:DataType="cs:SharedViewModel"
                        Background="{Binding UpdateBarBackground}"
                        Click="UpdateNotificationBar_Click">
                    <Grid>
                        <ProgressBar x:Name="UpdateProgressBar"
                                     Minimum="0"
                                     Maximum="100"
                                     Value="{Binding UpdateProgress}"
                                     Foreground="Green"
                                     Background="Transparent"
                                     IsHitTestVisible="False"
                                     VerticalAlignment="Stretch"
                                     HorizontalAlignment="Stretch" />
                        <TextBlock Text="A new update is available!"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0" />
                    </Grid>
                </Button>
            </Grid>
        </Grid>
    </Grid>
</Window>